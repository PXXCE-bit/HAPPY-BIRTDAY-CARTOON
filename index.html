<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>üéÑ ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î</title>
<style>
:root{
--bg:#070a18; --fg:#eaf2ff; --muted:#a9b7df; --accent:#66ffcc; --accent2:#86a8ff;
--danger:#ff6b6b; --card: rgba(10,16,40,.62);
--border: rgba(255,255,255,.12);
}
*{box-sizing:border-box}
body{
  margin: 0;
  min-height: 100vh;

  display: flex;
  align-items: center;
  justify-content: center;

  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;

  background: radial-gradient(1100px 520px at 50% 15%, #1b2a66, #070a18);
  color: #eaf2ff;

  /* ‚úÖ ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç: ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ö‡∏ô iPad */
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
}
canvas{position:fixed; inset:0; pointer-events:none;}
.wrap{width:min(980px,94vw); padding:14px; display:grid; gap:12px; grid-template-columns: 1.1fr .9fr;}
@media(max-width:980px){ .wrap{grid-template-columns:1fr;} }

.card{
background: var(--card);
border:1px solid var(--border);
border-radius:18px;
box-shadow: 0 22px 70px rgba(0,0,0,.5);
backdrop-filter: blur(10px);
padding:18px;
}
h1{margin:0 0 6px 0; font-size:20px}
.sub{margin:0 0 12px 0; color:var(--muted); font-size:13px}
.row{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}
.prompt{color:var(--accent)}
.ok{color:var(--accent)}
.err{min-height:18px; color:var(--danger); font-size:13px; margin-top:8px;}
.panel{border:1px solid rgba(255,255,255,.12); border-radius:16px; padding:14px; background: rgba(0,0,0,.20);}

input, button{
border-radius:12px;
border:1px solid rgba(255,255,255,.15);
background: rgba(0,0,0,.22);
color:var(--fg);
padding:12px 12px;
outline:none;
font: inherit;
}
input{flex:1; min-width: 220px;}
button{
cursor:pointer;
background: linear-gradient(135deg, rgba(102,255,204,.22), rgba(134,168,255,.16));
}
button:hover{transform: translateY(-1px);}
button:disabled{opacity:.55; cursor:not-allowed; transform:none;}

.bar{width:100%; height:10px; border-radius:999px; background: rgba(255,255,255,.10); overflow:hidden; border:1px solid rgba(255,255,255,.12);}
.fill{height:100%; width:0%; background: linear-gradient(90deg, rgba(102,255,204,.9), rgba(134,168,255,.9));}

.gallery{display:grid; gap:10px;}
.photo{
width:100%;
aspect-ratio: 16/10;
border-radius:14px;
border:1px solid rgba(255,255,255,.12);
background: rgba(0,0,0,.22);
overflow:hidden;
display:flex; align-items:center; justify-content:center;
position:relative;
}
.photo img{width:100%; height:100%; object-fit:cover; display:block;}
.cap{
position:absolute; left:10px; bottom:10px;
padding:6px 10px; border-radius:999px;
background: rgba(0,0,0,.42);
border:1px solid rgba(255,255,255,.14);
font-size:12px;
backdrop-filter: blur(6px);
}

.hidden{display:none !important;}
.big{font-size:28px; line-height:1.1; margin:0;}
.toast{
position:fixed; left:50%; top:16px; transform:translateX(-50%);
padding:10px 12px; border-radius:12px;
background: rgba(0,0,0,.55);
border:1px solid rgba(255,255,255,.14);
color:var(--fg); font-size:13px;
opacity:0; pointer-events:none;
transition: opacity .25s ease, transform .25s ease;
}
.toast.show{opacity:1; transform:translateX(-50%) translateY(4px);}

.letter{
white-space:pre-wrap;
line-height:1.8;
font-size:14px;
color:var(--fg);
}
</style>
</head>
<body>
<canvas id="confetti"></canvas>
<canvas id="fire"></canvas>
<div class="toast" id="toast"></div>

<div class="wrap">
<!-- LEFT -->
<div class="card">
<h1>üéÑ ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î (PEACE ‚Üí Cartoon)</h1>
<p class="sub">‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö 3 ‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÄ‡∏û‡∏•‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</p>

<!-- Start gate -->
<div class="panel" id="gatePanel" style="margin-top:12px">
<div class="row" style="justify-content:space-between;">
<div class="sub">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö</div>
<div class="sub">‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô <span id="stepLabel">0</span>/7</div>
</div>
<div class="bar" style="margin-top:8px"><div class="fill" id="fill"></div></div>

<p class="sub" style="margin-top:12px">
‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: <span class="prompt">‡∏ß‡∏±‡∏ô/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô/‡∏õ‡∏µ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏≠‡∏á Cartoon ‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏∞‡πÑ‡∏£?</span><br>
(‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö <span class="prompt">DD/MM/YYYY</span>)
</p>

<div class="row" style="margin-top:10px">
<input id="startPw" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î (DD/MM/YYYY)..." autocomplete="off" />
<button id="btnStart">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</button>
</div>
<div class="err" id="startErr"></div>

<div class="row" style="margin-top:12px; justify-content:space-between;">
<button id="btnPlay1">‚ñ∂ ‡πÄ‡∏•‡πà‡∏ô/‡∏´‡∏¢‡∏∏‡∏î ‡πÄ‡∏û‡∏•‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
<button id="btnFx">üéÜ ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå</button>
</div>

<audio id="song1" preload="auto" controls style="width:100%; margin-top:10px;"></audio>
<div class="sub" style="margin-top:8px;">
‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: iPad/iPhone ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á‡πÄ‡∏≠‡∏á 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á (‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î iOS)
</div>
</div>

<!-- Mission panel -->
<div class="panel hidden" id="missionPanel" style="margin-top:12px">
<p class="big" id="missionTitle">‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à</p>
<p class="sub" id="missionDesc"></p>

<div class="row">
<input id="missionInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö/‡∏£‡∏´‡∏±‡∏™..." autocomplete="off" />
<button id="btnSubmit">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
</div>
<div class="err" id="missionErr"></div>

<div class="row" style="margin-top:12px; justify-content:flex-end;">
<button id="btnFx2">üéâ ‡πÇ‡∏õ‡∏£‡∏¢ / üéÜ ‡∏û‡∏•‡∏∏</button>
</div>
</div>

<!-- Letter panel -->
<div class="panel hidden" id="letterPanel" style="margin-top:12px">
<p class="big">üì© ‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á Cartoon</p>
<div class="letter" id="letterText"></div>
<div class="row" style="margin-top:12px; justify-content:flex-end;">
<button id="btnNextAfterLetter">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
</div>
</div>

<!-- Color question -->
<div class="panel hidden" id="colorPanel" style="margin-top:12px">
<p class="big">‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</p>
<p class="sub">‡πÉ‡∏ô‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏°‡∏µ‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á ‚Äú‡∏™‡∏µ‚Ä¶‚Äù ‡πÉ‡∏´‡πâ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</p>
<div class="row">
<input id="colorInput" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö..." autocomplete="off" />
<button id="btnColor">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
</div>
<div class="err" id="colorErr"></div>
</div>

<!-- Final panel -->
<div class="panel hidden" id="finalPanel" style="margin-top:12px">
<p class="big">üéâ Happy Birthday Cartoon</p>
<p class="sub">‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‚úÖ</p>

<div class="row" style="justify-content:space-between;">
<button id="btnPlay2">‚ñ∂ ‡πÄ‡∏•‡πà‡∏ô/‡∏´‡∏¢‡∏∏‡∏î ‡πÄ‡∏û‡∏•‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</button>
</div>

<audio id="song2" preload="auto" controls style="width:100%; margin-top:10px;"></audio>
</div>
</div>

<!-- RIGHT -->
<div class="card">
<h1>üñºÔ∏è ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å</h1>
<p class="sub">‡∏£‡∏π‡∏õ‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏ó‡∏µ‡∏•‡∏∞‡∏£‡∏π‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ó‡∏≥‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>

<div class="gallery">
<div class="photo" id="imgBox1">
<div class="sub">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 1 (‡∏´‡∏•‡∏±‡∏á‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à 1)</div>
</div>
<div class="photo" id="imgBox2">
<div class="sub">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 2 (‡∏´‡∏•‡∏±‡∏á‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à 2)</div>
</div>
<div class="photo" id="imgBox3">
<div class="sub">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 3 (‡∏´‡∏•‡∏±‡∏á‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à 3)</div>
</div>
</div>

<div class="panel" style="margin-top:12px">
<div class="sub">
‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÉ‡∏ô repo (root):<br>
<span class="prompt">p1.jpg, p2.jpg, p3.jpg, pause.mp3, happy-birthday.(mp3/m4a)</span>
</div>
</div>
</div>
</div>

<script>
/* =========================
‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
=========================
‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô ‚Äú‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î Cartoon‚Äù ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ï‡∏≠‡∏ö
‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏ú‡∏°‡∏¢‡∏±‡∏á‡πÉ‡∏™‡πà‡πÄ‡∏õ‡πá‡∏ô 00/00/0000 ‡πÑ‡∏ß‡πâ‡∏Å‡∏±‡∏ô‡∏´‡∏•‡∏∏‡∏î (‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢)
*/
const CONFIG = {
cartoonBirthday: "18/12/2006", // <<<<<< ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á Cartoon (DD/MM/YYYY)
song1: "pause.mp3",
song2: "happy-birthday.mp3", // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô .m4a ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô "happy-birthday.m4a"
img1: "p1.jpg",
img2: "p2.jpg",
img3: "p3.jpg",
};

const LETTER = `Happy Birthday ‡∏Ñ‡∏£‡∏±‡∏ö‡∏≠‡πâ‡∏ß‡∏ô ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡∏∞‡∏ï‡∏•‡∏≠‡∏î‡πÑ‡∏õ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏Ç‡∏≠‡∏á‡πÄ‡∏ò‡∏≠ ‡∏Ç‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏°‡∏≤‡∏Å‡πÜ‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡πÜ‡∏ß‡∏±‡∏ô ‡∏ó‡∏ô‡∏ü‡∏±‡∏á‡πÄ‡∏£‡∏≤‡∏û‡∏π‡∏î‡πÑ‡∏õ‡∏ô‡∏≤‡∏ô‡πÜ ‡∏ö‡∏≤‡∏á‡∏ó‡∏µ‡πÄ‡∏£‡∏≤‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à‡∏Å‡∏±‡∏ô‡∏ö‡πâ‡∏≤‡∏á ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏£‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏Ñ‡πâ‡∏≤‡∏ñ‡∏π‡∏Å‡πÄ‡∏™‡∏°‡∏≠ ‡∏´‡∏¢‡∏≠‡∏Å‡∏à‡∏±‡πâ‡∏ü ‡∏ô‡∏±‡πà‡∏ô‡πÅ‡∏´‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏°‡∏≤‡∏Å‡πÜ‡πÄ‡∏î‡πâ‡∏≠‡∏≠‡πâ‡∏ß‡∏ô ‡∏à‡∏≤‡∏Å PEACE ‡∏™‡∏∏‡∏î‡∏´‡∏•‡πà‡∏≠ ‡∏ñ‡∏∂‡∏á ‡πÄ‡∏ò‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏ß‡∏¢‡∏™‡∏î‡∏á‡∏î‡∏á‡∏≤‡∏° ‡∏™‡∏µ‚Ä¶`;

/* =========================
State: 0..7
========================= */
let step = 0;

const $ = (id)=>document.getElementById(id);
const toast = (msg)=>{
const t=$("toast");
t.textContent=msg;
t.classList.add("show");
setTimeout(()=>t.classList.remove("show"), 1600);
};
const norm = (s)=> (s ?? "").trim();
const normLower = (s)=> norm(s).toLowerCase();

function setProgress(){
const pct = Math.min(100, Math.round((step/7)*100));
$("stepLabel").textContent = step;
$("fill").style.width = pct + "%";
}
setProgress();

/* =========================
Effects
========================= */
const c1 = $("confetti"), x1 = c1.getContext("2d");
const c2 = $("fire"), x2 = c2.getContext("2d");
let W=0,H=0, parts=[], sparks=[], fireLooping=false;

function resize(){
W = c1.width = window.innerWidth;
H = c1.height = window.innerHeight;
c2.width = window.innerWidth;
c2.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

function makePart(){
return {
x: Math.random()*W, y: Math.random()*-H,
r: 3+Math.random()*6,
vx: -1+Math.random()*2,
vy: 2+Math.random()*5,
rot: Math.random()*Math.PI,
vr: -0.12+Math.random()*0.24,
hue: Math.random()*360
};
}
function startConfetti(){
parts = Array.from({length: 140}, ()=>makePart());
requestAnimationFrame(tickConfetti);
}
function burstConfetti(n=120){
for(let i=0;i<n;i++){
const p = makePart();
p.y = Math.random()*H*0.25;
p.vy = 4+Math.random()*7;
parts.push(p);
}
parts = parts.slice(-420);
}
function tickConfetti(){
x1.clearRect(0,0,W,H);
for(const p of parts){
p.x += p.vx; p.y += p.vy; p.rot += p.vr;
if(p.y > H+30){ p.y=-30; p.x=Math.random()*W; }
x1.save();
x1.translate(p.x,p.y); x1.rotate(p.rot);
x1.fillStyle = `hsla(${p.hue},90%,65%,.95)`;
x1.fillRect(-p.r, -p.r, p.r*2, p.r*2);
x1.restore();
}
requestAnimationFrame(tickConfetti);
}
function fireworksBurst(count=10){
for(let i=0;i<count;i++){
const cx = Math.random()*W*0.9 + W*0.05;
const cy = Math.random()*H*0.45 + H*0.05;
const hue = Math.random()*360;
for(let k=0;k<32;k++){
const a = (Math.PI*2) * (k/32);
const sp = 2 + Math.random()*4.5;
sparks.push({
x: cx, y: cy,
vx: Math.cos(a)*sp*(0.7+Math.random()*0.7),
vy: Math.sin(a)*sp*(0.7+Math.random()*0.7),
life: 40 + Math.random()*22,
hue
});
}
}
if(!fireLooping){ fireLooping=true; requestAnimationFrame(tickFire); }
}
function tickFire(){
x2.clearRect(0,0,c2.width,c2.height);
for(const s of sparks){
s.x += s.vx; s.y += s.vy;
s.vy += 0.04;
s.life -= 1;
x2.beginPath();
x2.arc(s.x, s.y, 1.6, 0, Math.PI*2);
x2.fillStyle = `hsla(${s.hue},95%,70%,${Math.max(0,s.life/60)})`;
x2.fill();
}
sparks = sparks.filter(s=>s.life>0);
if(sparks.length>0) requestAnimationFrame(tickFire);
else { fireLooping=false; x2.clearRect(0,0,c2.width,c2.height); }
}
startConfetti();

/* =========================
Audio: ‡∏Å‡∏±‡∏ô‡πÄ‡∏û‡∏•‡∏á‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô (‡∏Ç‡πâ‡∏≠ 1)
========================= */
const song1 = $("song1");
const song2 = $("song2");
song1.src = CONFIG.song1;
song2.src = CONFIG.song2;

// ‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏•‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÄ‡∏•‡πà‡∏ô ‡∏≠‡∏µ‡∏Å‡πÄ‡∏û‡∏•‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏¢‡∏∏‡∏î
function stopOther(current){
const other = (current === song1) ? song2 : song1;
if(!other.paused){
other.pause();
}
}

// ‡∏ñ‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏î play ‡∏ó‡∏µ‡πà controls ‡πÄ‡∏≠‡∏á ‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏´‡∏¢‡∏∏‡∏î‡∏≠‡∏µ‡∏Å‡πÄ‡∏û‡∏•‡∏á‡∏î‡πâ‡∏ß‡∏¢
song1.addEventListener("play", ()=>stopOther(song1));
song2.addEventListener("play", ()=>stopOther(song2));

async function togglePlay(audioEl, btnEl, labelPlay, labelPause){
stopOther(audioEl);
audioEl.load(); // iOS safe
try{
if(audioEl.paused){
await audioEl.play();
btnEl.textContent = labelPause;
toast("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á üéµ");
}else{
audioEl.pause();
btnEl.textContent = labelPlay;
toast("‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏û‡∏•‡∏á‡πÅ‡∏•‡πâ‡∏ß");
}
}catch(e){
console.log(e);
alert("‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏•‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ\n\n‡πÄ‡∏ä‡πá‡∏Å‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô repo ‡πÅ‡∏•‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏£‡∏á‡πÄ‡∏õ‡πä‡∏∞\n- pause.mp3\n- happy-birthday.mp3 ‡∏´‡∏£‡∏∑‡∏≠ .m4a\n\n‡∏ö‡∏ô iPad ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏î‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏≠‡∏á 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á");
}
}

/* =========================
UI helpers
========================= */
function show(elId){ $(elId).classList.remove("hidden"); }
function hide(elId){ $(elId).classList.add("hidden"); }

function setMission(title, desc, placeholder){
$("missionTitle").textContent = title;
$("missionDesc").textContent = desc;
$("missionInput").value = "";
$("missionInput").placeholder = placeholder || "‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö/‡∏£‡∏´‡∏±‡∏™...";
$("missionErr").textContent = "";
}

function revealImage(which){
const mk = (src, capText)=>{
const img = document.createElement("img");
img.src = src;
const cap = document.createElement("div");
cap.className = "cap";
cap.textContent = capText;
return {img, cap};
};

if(which === 1){
const box = $("imgBox1");
box.innerHTML = "";
const {img, cap} = mk(CONFIG.img1, "‚úÖ ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 1 ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß");
box.appendChild(img); box.appendChild(cap);
}
if(which === 2){
const box = $("imgBox2");
box.innerHTML = "";
const {img, cap} = mk(CONFIG.img2, "‚úÖ ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 2 ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß");
box.appendChild(img); box.appendChild(cap);
}
if(which === 3){
const box = $("imgBox3");
box.innerHTML = "";
const {img, cap} = mk(CONFIG.img3, "‚úÖ ‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 3 ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß");
box.appendChild(img); box.appendChild(cap);
}
}

/* =========================
Flow
========================= */
function goStep(newStep){
step = newStep;
setProgress();

if(step === 0){
show("gatePanel"); hide("missionPanel"); hide("letterPanel"); hide("colorPanel"); hide("finalPanel");
}
if(step >= 1 && step <= 4){
hide("gatePanel"); show("missionPanel"); hide("letterPanel"); hide("colorPanel"); hide("finalPanel");
}
if(step === 5){
hide("missionPanel"); show("letterPanel"); hide("colorPanel"); hide("finalPanel");
}
if(step === 6){
hide("letterPanel"); show("colorPanel"); hide("finalPanel");
}
if(step === 7){
hide("colorPanel"); show("finalPanel");
}

if(step === 1){
setMission(
"‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 1",
"‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°: ‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏≠‡∏á PEACE ‡∏Ñ‡∏∑‡∏≠‡∏ß‡∏±‡∏ô‡πÑ‡∏´‡∏ô?",
"‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö DD/MM/YYYY"
);
}
if(step === 2){
setMission(
"‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 2",
"‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏£‡∏π‡∏õ Cartoon ‡∏ä‡∏π 2 ‡∏ô‡∏¥‡πâ‡∏ß‡∏°‡∏≤‡πÉ‡∏ô LINE ‡πÉ‡∏´‡πâ PEACE ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏à‡∏≤‡∏Å‡πÉ‡∏ô LINE (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ)",
"‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö..."
);
}
if(step === 3){
setMission(
"‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ó‡∏µ‡πà 3",
"‡πÉ‡∏´‡πâ‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÉ‡∏´‡πâ PEACE 10 ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏´‡∏±‡∏™‡πÉ‡∏ô IG (‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ)",
"‡∏û‡∏¥‡∏°‡∏û‡πå‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö..."
);
}
if(step === 4){
setMission(
"‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô ‚úÖ",
"‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÑ‡∏´‡∏°? ‡∏ñ‡πâ‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏° ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ ‚Äú‡∏û‡∏£‡πâ‡∏≠‡∏°‚Äù",
"‡∏û‡∏¥‡∏°‡∏û‡πå: ‡∏û‡∏£‡πâ‡∏≠‡∏°"
);
}
if(step === 5){
$("letterText").textContent = LETTER;
}
}

goStep(0);

/* =========================
Start: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡πÄ‡∏Å‡∏¥‡∏î Cartoon (‡∏Ç‡πâ‡∏≠ 2)
========================= */
$("btnStart").addEventListener("click", ()=>{
const v = norm($("startPw").value);
$("startErr").textContent = "";
if(v !== CONFIG.cartoonBirthday){
$("startErr").textContent = "‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
return;
}
toast("‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡πÅ‡∏•‡πâ‡∏ß ‚úÖ");
burstConfetti(140);
fireworksBurst(10);
goStep(1);
});
$("startPw").addEventListener("keydown", (e)=>{ if(e.key==="Enter") $("btnStart").click(); });

$("btnPlay1").addEventListener("click", ()=> togglePlay(song1, $("btnPlay1"), "‚ñ∂ ‡πÄ‡∏•‡πà‡∏ô/‡∏´‡∏¢‡∏∏‡∏î ‡πÄ‡∏û‡∏•‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å", "‚è∏ ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏û‡∏•‡∏á‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å"));
$("btnPlay2").addEventListener("click", ()=> togglePlay(song2, $("btnPlay2"), "‚ñ∂ ‡πÄ‡∏•‡πà‡∏ô/‡∏´‡∏¢‡∏∏‡∏î ‡πÄ‡∏û‡∏•‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢", "‚è∏ ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏û‡∏•‡∏á‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢"));

$("btnFx").addEventListener("click", ()=>{ burstConfetti(180); fireworksBurst(14); });
$("btnFx2").addEventListener("click", ()=>{ burstConfetti(180); fireworksBurst(12); });

/* =========================
Mission submit (‡∏Ç‡πâ‡∏≠ 3: ‡πÑ‡∏°‡πà‡∏°‡∏µ hint/‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏â‡∏•‡∏¢)
========================= */
$("btnSubmit").addEventListener("click", ()=>{
const ansRaw = norm($("missionInput").value);
const ansLower = normLower(ansRaw);
$("missionErr").textContent = "";

if(step === 1){
// ‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏à‡∏£‡∏¥‡∏á: 04/05/2007 (‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏≥‡∏´‡∏ô‡∏î)
if(ansRaw !== "04/05/2007"){
$("missionErr").textContent = "‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
return;
}
revealImage(1);
toast("‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 1 ‚úÖ");
burstConfetti(140);
goStep(2);
return;
}

if(step === 2){
if(ansRaw !== "PEACE SUD LOR" && ansLower !== "peace sud lor"){
$("missionErr").textContent = "‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
return;
}
revealImage(2);
toast("‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 2 ‚úÖ");
fireworksBurst(12);
goStep(3);
return;
}

if(step === 3){
if(ansRaw !== "‡∏á‡πâ‡∏ß‡∏¢‡∏¢‡∏¢‡∏¢‡∏¢‡∏¢" && ansLower !== "‡∏á‡πâ‡∏ß‡∏¢‡∏¢‡∏¢‡∏¢‡∏¢‡∏¢"){
$("missionErr").textContent = "‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
return;
}
revealImage(3);
toast("‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 3 ‚úÖ");
burstConfetti(200);
fireworksBurst(18);
goStep(4);
return;
}

if(step === 4){
if(ansRaw !== "‡∏û‡∏£‡πâ‡∏≠‡∏°"){
$("missionErr").textContent = "‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
return;
}
toast("‡πÄ‡∏õ‡∏¥‡∏î‡∏à‡∏î‡∏´‡∏°‡∏≤‡∏¢‡πÅ‡∏•‡πâ‡∏ß üì©");
goStep(5);
return;
}
});
$("missionInput").addEventListener("keydown", (e)=>{ if(e.key==="Enter") $("btnSubmit").click(); });

/* =========================
Letter next
========================= */
$("btnNextAfterLetter").addEventListener("click", ()=>{
goStep(6);
});

/* =========================
Color question
========================= */
$("btnColor").addEventListener("click", ()=>{
const v = norm($("colorInput").value);
$("colorErr").textContent = "";
if(v !== "‡∏ó‡∏≠‡∏á"){
$("colorErr").textContent = "‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á";
return;
}
toast("‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‚úÖ ‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢");
fireworksBurst(18);
burstConfetti(220);
goStep(7);
});
$("colorInput").addEventListener("keydown", (e)=>{ if(e.key==="Enter") $("btnColor").click(); });
</script>
</body>

</html>
